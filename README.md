# Export
Выгрузка дневников дайри
Для функционирования кода необходимо вписать ключ и пароль от api diary.



версия 1.2

Скрипт для запуска из консоли console_parse_diary_api.py
* Можно вызвать с аргументами командной строки - логин и пароль через пробел
* Если логин и пароль не были переданы как аргументы запуска, их можно ввести двумя отдельными строками
* Убран практически весь синтаксический сахар. На выход подаются строки:
  * "GOT POSTS #" //контроль за процессом выполнения, # - число
  * "DONE" //все данные получены
  * json-объект аккаунта
  * json-объекты записей //последовательно, по одной за раз
  * "END" //окончание работы скрипта
* Добавлен минимальный парсинг записей и комментариев для приведения тегов [MORE] и [J] к единому виду

_____________

версия 1.1

Исправлено получение данных через html при кириллице в логине или пароле.

Код почищен. Добавлены уточняющие сообщения по ходу выгрузки.

_____________

версия 1

Для дневника считывается timezone, т.к. время опубликования записи или комментария хранится в UTC.

Исправлена выгрузка записей из сообществ - тела сообщений не выдавались из-за урезанных прав доступа владельца аккаунта сообщества. Теперь в телах сообщений из сообществ может присутствовать строка типа \<br\>\<div\>\<a href='...'\>вернуть запись на место\<\/a\>\<\/div\>  - необходимо почистить при постобработке.

Исправлено считывание голосований.

_____________

Начальная версия, не включающая в себя обработку тега MORE и создания списка ссылок, ведущих на diary.ru.
Не производится выгрузка умылов, хоть она и возможна.
Не используется запрос "journal.get" из-за бага белого списка.

Собираются данные аккаунта, записи, комментарии, данные голосований из записей, списки доступа (к записи, к дневнику, к профилю, к комментированию, белый, черный).
Обрабатывает как дневники, так и сообщества.
При отсутствии у пользователя дневника собирает только данные аккаунта (в том числе списки доступа).
При отсутствии записей в дневнике работает корректно.
Есть обход проверки cloudflare.

parse_diary_api - основной файл; 

scrape - обход проверки cloudflare на основе https://github.com/Anorov/cloudflare-scrape;

diary_dybr.json - пример выгрузки
